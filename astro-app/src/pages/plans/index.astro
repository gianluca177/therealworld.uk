---
import Layout from "../../layouts/Layout-plans.astro";

/**
 * PLANS DATA
 * - iconSrc: local placeholder path for the plan icon (swap later)
 * - status: "active" | "limited" | "soldout"
 * - featured: adds the orange glow + highlight border (like Conquer card)
 */
const plans = [
  {
    name: "Conquer",
    tag: "Available",
    priceMain: "$99",
    priceSub: "per month",
    iconAlt: "Conquer icon",
    iconSrc: "/images/plan-icons/conquer.svg", // TODO: replace
    bullets: [
      "Access to all skill campuses",
      "Step-by-step learning & priority support",
      "Community chats + mentor guidance",
      "Cancel anytime via the official provider",
    ],
    cta: "Continue to official checkout",
    href: "https://jointherealworld.com/checkout?a=7nrnndpb",
    featured: true,
    status: "active",
  },
  {
    name: "Champion",
    tag: "Limited",
    priceMain: "From $99",
    priceSub: "availability varies",
    iconAlt: "Champion icon",
    iconSrc: "/images/plan-icons/champion.svg", // TODO: replace
    bullets: [
      "Availability can change",
      "Confirm details on the official checkout",
      "No payments processed on this website",
    ],
    cta: "View official plans",
    href: "https://jointherealworld.com/checkout?a=7nrnndpb",
    featured: false,
    status: "limited",
  },
  {
    name: "Vanguard",
    tag: "Sold out",
    priceMain: "$499",
    priceSub: "per month",
    iconAlt: "Vanguard icon",
    iconSrc: "/images/plan-icons/vanguard.svg", // TODO: replace
    bullets: [
      "Status shown on official checkout",
      "Some tiers may be closed/sold out",
      "See current options instantly",
    ],
    cta: "View official plans",
    href: "https://jointherealworld.com/checkout?a=7nrnndpb",
    featured: false,
    status: "soldout",
  },
];

/**
 * PLACEHOLDERS
 * Swap these later with real assets.
 */
const brandLogoSrc = "/images/brand/logo-circle.png"; // TODO: replace (or remove)
const avatarPlaceholderSrc = "/images/placeholders/avatar.png"; // TODO: replace
---

<Layout
  title="Plans | Hustlers University UK"
  description="Choose a plan and continue to the official checkout."
>
  <section class="bg-black text-white">
    <div class="mx-auto max-w-6xl px-4 py-20">
      {/* Top logo (optional, keeps the "checkout" vibe) */}
      <div class="flex justify-center">
        <img
          src={brandLogoSrc}
          alt="Hustlers University UK"
          class="h-12 w-12 rounded-full border border-white/10 object-cover"
          loading="lazy"
        />
      </div>

      <h1 class="mt-6 text-center text-3xl font-bold tracking-tight text-white md:text-5xl">
        Choose Your Plan
      </h1>

      {/* Toggle (visual only / non-interactive) */}
      <div class="mt-8 flex items-center justify-center gap-4 text-sm">
        <span class="font-medium text-white/80">Monthly</span>

        <div class="relative h-7 w-14 rounded-full border border-white/10 bg-white/10">
          <div class="absolute left-1 top-1 h-5 w-5 rounded-full bg-[#FF8C2A] shadow-[0_0_18px_rgba(255,140,42,0.35)]"></div>
        </div>

        <span class="text-white/60">
          Yearly <span class="font-semibold text-green-400">(17% off)</span>
        </span>
      </div>

      {/* Cards wrapper
          - Mobile: stacked
          - Desktop: Conquer + Champion side-by-side, Vanguard below (like the screenshot flow)
      */}
      <div class="mt-12 grid gap-8">
        {/* Row 1: Conquer + Champion */}
        <div class="grid gap-8 md:mx-auto md:max-w-4xl md:grid-cols-2">
          {plans.slice(0, 2).map((p) => (
            <PlanCard plan={p} />
          ))}
        </div>

        {/* Row 2: Vanguard full width */}
        <div class="md:mx-auto md:max-w-4xl">
          <PlanCard plan={plans[2]} fullWidth />
        </div>
      </div>

      {/* Social proof line */}
      <div class="mt-10 flex items-center justify-center gap-3 text-sm text-white/70">
        <div class="flex -space-x-2">
          {/* Placeholder avatars */}
          <img
            src={avatarPlaceholderSrc}
            alt="Member avatar"
            class="h-6 w-6 rounded-full border border-white/10 object-cover"
            loading="lazy"
          />
          <img
            src={avatarPlaceholderSrc}
            alt="Member avatar"
            class="h-6 w-6 rounded-full border border-white/10 object-cover"
            loading="lazy"
          />
          <img
            src={avatarPlaceholderSrc}
            alt="Member avatar"
            class="h-6 w-6 rounded-full border border-white/10 object-cover"
            loading="lazy"
          />
        </div>

        <p>
          Join <span class="font-semibold text-[#FF8C2A]">155,000+</span> members already leveling up inside
        </p>
      </div>

      {/* Asterisk line */}
      <div class="mt-8 text-center text-xs text-white/45">
        <p>*All prices are presented in USD.</p>
        <p class="mt-2">
          This website does not process payments. Plan details and checkout are handled on the official provider site.
        </p>
      </div>
    </div>
  </section>
</Layout>

{/* -------------------------------------------------------
    COMPONENT: PlanCard (inline, keeps this file self-contained)
    - If you want, we can extract it to /src/components/PlanCard.astro
-------------------------------------------------------- */}
---
/** @type {{ plan: any, fullWidth?: boolean }} */
const { plan, fullWidth = false } = Astro.props;
const isSoldOut = plan.status === "soldout";
const isFeatured = Boolean(plan.featured);

const cardBase =
  "relative rounded-3xl bg-[#0F0F0F] border p-7 md:p-8 transition";
const cardFeatured =
  "border-[#FF8C2A66] shadow-[0_0_0_1px_rgba(255,140,42,0.16),0_0_42px_rgba(255,140,42,0.20)]";
const cardNormal =
  "border-white/10 hover:border-[#FF8C2A33]";
const cardWidth = fullWidth ? "" : "";

const ctaBase =
  "inline-flex w-full items-center justify-center rounded-xl px-6 py-3 font-semibold transition";
const ctaFeatured =
  "bg-white/10 border border-white/15 text-white hover:border-[#FF8C2A55] hover:bg-white/5";
const ctaNormal =
  "bg-white/5 border border-white/10 text-white/80 hover:text-white hover:border-[#FF8C2A33]";
const ctaDisabledLook = isSoldOut ? "opacity-70" : "";
---

<div class={[cardBase, isFeatured ? cardFeatured : cardNormal, cardWidth].join(" ")}>
  {/* SOLD OUT ribbon */}
  {isSoldOut && (
    <div class="absolute right-5 top-5 rotate-12">
      <span class="inline-flex items-center rounded-full border border-red-500/40 bg-red-600/20 px-3 py-1 text-[11px] font-semibold text-red-200">
        SOLD OUT
      </span>
    </div>
  )}

  {/* Header */}
  <div class="flex items-start justify-between gap-4">
    <div>
      <p class="text-xs uppercase tracking-widest text-white/60">
        {plan.name}
      </p>

      <div class="mt-2 flex items-end gap-2">
        <span class="text-4xl font-extrabold leading-none text-white">
          {plan.priceMain}
        </span>
        <span class="mb-1 text-xs uppercase tracking-wider text-white/60">
          {plan.priceSub}
        </span>
      </div>
    </div>

    <span class="rounded-full border border-white/10 px-3 py-1 text-[10px] text-white/70">
      {plan.tag}
    </span>
  </div>

  {/* Plan icon (placeholder) */}
  <div class="mt-6 flex justify-end">
    <img
      src={plan.iconSrc}
      alt={plan.iconAlt}
      class="h-16 w-16 opacity-90"
      loading="lazy"
      onerror="this.style.display='none'"
    />
    {/* NOTE:
        If the icon file is missing, it will hide itself.
        Replace /images/plan-icons/*.svg later.
    */}
  </div>

  {/* Bullets */}
  <ul class="mt-6 space-y-3 text-sm text-white/70">
    {plan.bullets.map((b) => (
      <li class="flex items-start gap-3">
        <span class="mt-2 h-1.5 w-1.5 rounded-full bg-[#22c55e]"></span>
        <span>{b}</span>
      </li>
    ))}
  </ul>

  {/* CTA */}
  <div class="mt-8">
    <a
      href={plan.href}
      class={[
        ctaBase,
        isFeatured ? ctaFeatured : ctaNormal,
        ctaDisabledLook,
      ].join(" ")}
      rel="nofollow sponsored noopener"
      target="_blank"
    >
      {plan.cta}
    </a>

    {isSoldOut && (
      <p class="mt-3 text-xs text-white/40">
        Note: This card is informational. Availability is shown on the official checkout.
      </p>
    )}
  </div>
</div>